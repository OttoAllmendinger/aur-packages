# PKGBUILD by Berseker <berseker86@gmail.com>
# Based mostly on the great bin32-google-earth PKGBUILD by srabd

pkgname=google-earth
pkgver=6.0.0.1735
pkgrel=1
pkgdesc="A 3D interface to the planet Earth"
url="http://earth.google.com"
license=('custom')
depends=('curl' 'qt' 'ld-lsb=3')
install=googleearth.install


conflicts=('bin32-google-earth')
source=(http://dl.google.com/earth/client/current/GoogleEarthLinux.bin
        http://earth.google.com/intl/en/license.html 
        googleearth 
        googleearth.desktop 
        googleearth-mimetypes.xml 
        googleearth.install)
arch=('i686')


build() {
	cd ${startdir}/src

	# Extract archive
	sh ./GoogleEarthLinux.bin --noexec --target ${startdir}/src/${pkgname}
}

package() {
	# Install binaries and data files
	mkdir -p ${pkgdir}/opt/${pkgname}
	tar -xpf ${srcdir}/${pkgname}/googleearth-linux-x86.tar -C ${pkgdir}/opt/${pkgname}/
	tar -xpf ${srcdir}/${pkgname}/googleearth-data.tar -C ${pkgdir}/opt/${pkgname}/

	# Install executable
	install -D -m755 ${srcdir}/googleearth ${pkgdir}/usr/bin/googleearth

	# Install .desktop file
	install -D -m644 ${startdir}/src/googleearth.desktop ${pkgdir}/usr/share/applications/googleearth.desktop

	# Install shared MIME info package
	install -D -m644 ${startdir}/src/googleearth-mimetypes.xml ${pkgdir}/usr/share/mime/packages/googleearth-mimetypes.xml

	# Install icon
	install -D -m644 ${startdir}/src/${pkgname}/googleearth-icon.png ${pkgdir}/usr/share/pixmaps/googleearth-icon.png
	
	# Install license
	install -D -m644 ${startdir}/src/license.html ${pkgdir}/usr/share/licenses/${pkgname}/license.html

	# Change ownership to root
	chown -R root:root ${startdir}/pkg/*
}

md5sums=('29f8a64744eb5dd05320bd2862d151b4'
         '757d9726191f365209fa13acdd0ab6e7'
         '7ab657c98f5c25f560fdd6b0ae37a957'
         'd819a1961382826b7f92ee32dd67f2e1'
         '84e1efd656f86c52333cc629b31accb0'
         '2922f8668ae19e6d9c558aaadda90af8')
